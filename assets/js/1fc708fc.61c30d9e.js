"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9197],{3905:function(e,n,a){a.d(n,{Zo:function(){return p},kt:function(){return g}});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function o(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=t.createContext({}),d=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},p=function(e){var n=d(e.components);return t.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(a),g=r,m=u["".concat(s,".").concat(g)]||u[g]||c[g]||o;return a?t.createElement(m,i(i({ref:n},p),{},{components:a})):t.createElement(m,i({ref:n},p))}));function g(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=a[d];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},93920:function(e,n,a){a.d(n,{Z:function(){return i}});var t=a(67294),r="tableOfContentsInline_ifKN",o=a(31498);function i(e){var n=e.toc,a=e.minHeadingLevel,i=e.maxHeadingLevel,l=e.filterTOC;return t.createElement("div",{className:r},t.createElement(o.Z,{toc:n,minHeadingLevel:a,maxHeadingLevel:i,className:"table-of-contents",linkClassName:null,filterTOC:l}))}},31498:function(e,n,a){a.d(n,{Z:function(){return d}});var t=a(83117),r=a(80102),o=a(67294),i=a(89575),l=["toc","className","linkClassName","linkActiveClassName","minHeadingLevel","maxHeadingLevel"];function s(e){var n=e.toc,a=e.className,t=e.linkClassName,r=e.isChild;return n.length?o.createElement("ul",{className:r?void 0:a},n.map((function(e){return o.createElement("li",{key:e.id},o.createElement("a",{href:"#"+e.id,className:null!=t?t:void 0,dangerouslySetInnerHTML:{__html:e.value}}),o.createElement(s,{isChild:!0,toc:e.children,className:a,linkClassName:t}))}))):null}function d(e){var n=e.toc,a=e.className,d=void 0===a?"table-of-contents table-of-contents__left-border":a,p=e.linkClassName,c=void 0===p?"table-of-contents__link":p,u=e.linkActiveClassName,g=void 0===u?void 0:u,m=e.minHeadingLevel,h=e.maxHeadingLevel,v=(0,r.Z)(e,l),f=(0,i.LU)(),w=null!=m?m:f.tableOfContents.minHeadingLevel,k=null!=h?h:f.tableOfContents.maxHeadingLevel,y=(0,i.b9)({toc:n,minHeadingLevel:w,maxHeadingLevel:k});"function"==typeof v.filterTOC&&(y=v.filterTOC(y));var N=(0,o.useMemo)((function(){if(c&&g)return{linkClassName:c,linkActiveClassName:g,minHeadingLevel:w,maxHeadingLevel:k}}),[c,g,w,k]);return(0,i.Si)(N),o.createElement(s,(0,t.Z)({toc:y,className:d,linkClassName:c},v))}},88053:function(e,n,a){a.r(n),a.d(n,{assets:function(){return p},contentTitle:function(){return s},default:function(){return g},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return c}});var t=a(83117),r=a(80102),o=(a(67294),a(3905)),i=(a(93920),["components"]),l={description:"Downgrade Hasura GraphQL engine version",keywords:["hasura","docs","deployment","downgrade","version"],sidebar_position:13,sidebar_label:"Downgrading GraphQL engine"},s="Downgrading Hasura GraphQL engine",d={unversionedId:"graphql/core/deployment/downgrading",id:"graphql/core/deployment/downgrading",title:"Downgrading Hasura GraphQL engine",description:"Downgrade Hasura GraphQL engine version",source:"@site/docs/graphql/core/deployment/downgrading.mdx",sourceDirName:"graphql/core/deployment",slug:"/graphql/core/deployment/downgrading",permalink:"/docs/latest/graphql/core/deployment/downgrading",editUrl:"https://github.com/hasura/graphql-engine/edit/master/docs/docs/graphql/core/deployment/downgrading.mdx",tags:[],version:"current",sidebarPosition:13,frontMatter:{description:"Downgrade Hasura GraphQL engine version",keywords:["hasura","docs","deployment","downgrade","version"],sidebar_position:13,sidebar_label:"Downgrading GraphQL engine"},sidebar:"docsSidebar",previous:{title:"Updating GraphQL engine",permalink:"/docs/latest/graphql/core/deployment/updating-graphql-engine"},next:{title:"Hasura CLI",permalink:"/docs/latest/graphql/core/hasura-cli/index"}},p={},c=[{value:"Step 1: Update Hasura GraphQL engine image version",id:"step-1-update-hasura-graphql-engine-image-version",level:2},{value:"Step 2: Downgrade Hasura catalogue version",id:"step-2-downgrade-hasura-catalogue-version",level:2}],u={toc:c};function g(e){var n=e.components,a=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,t.Z)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"downgrading-hasura-graphql-engine"},"Downgrading Hasura GraphQL engine"),(0,o.kt)("h2",{id:"step-1-update-hasura-graphql-engine-image-version"},"Step 1: Update Hasura GraphQL engine image version"),(0,o.kt)("p",null,"The Hasura GraphQL engine runs off a Docker image and downgrades are as\nsimple as changing the image tag to the version you want."),(0,o.kt)("p",null,"Based on your deployment method, follow the appropriate guide to\ndowngrade the GraphQL engine version you're running:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/latest/graphql/core/deployment/deployment-guides/heroku#heroku-update"},"Updating on Heroku")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/latest/graphql/core/deployment/deployment-guides/docker#docker-update"},"Updating on Docker")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/latest/graphql/core/deployment/deployment-guides/kubernetes#kubernetes-update"},"Updating on Kubernetes"))),(0,o.kt)("p",null,"If the GraphQL engine version you are downgrading to has a different\ncatalogue version than your current, you will have to downgrade the\ncatalogue to the corresponding version manually as described below."),(0,o.kt)("h2",{id:"step-2-downgrade-hasura-catalogue-version"},"Step 2: Downgrade Hasura catalogue version"),(0,o.kt)("p",null,'The Hasura GraphQL engine maintains its metadata state in a "catalogue"\nas described ',(0,o.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/how-it-works/metadata-schema"},"here"),". The schema of the\ncatalogue is versioned. Updates to the Hasura GraphQL engine may have\nHasura catalogue version bumps."),(0,o.kt)("p",null,"Downgrades to the catalogue need to be carried out manually in case you\nare attempting to downgrade to a lower Hasura GraphQL engine version."),(0,o.kt)("p",null,"From ",(0,o.kt)("inlineCode",{parentName:"p"},"v1.2.0"),", you can downgrade the catalogue from a particular version\nto a previous version by executing the ",(0,o.kt)("inlineCode",{parentName:"p"},"graphql-engine")," executable on\nthe command line, with the ",(0,o.kt)("inlineCode",{parentName:"p"},"downgrade")," command, specifying the desired\ncatalogue version using one of the ",(0,o.kt)("inlineCode",{parentName:"p"},"--to-")," flags. For earlier versions,\nit is recommended to first upgrade to the latest version and then use\nthe ",(0,o.kt)("inlineCode",{parentName:"p"},"downgrade")," command to downgrade to the desired version."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"downgrade")," command is not part of the Hasura CLI but rather a\ncommand on ",(0,o.kt)("inlineCode",{parentName:"p"},"graphql-engine")," itself. The way to execute this command is\nto run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -e HASURA_GRAPHQL_DATABASE_URL=$DATABASE_URL hasura/graphql-engine:<VERSION> graphql-engine downgrade --to-<NEW-VERSION>\n")),(0,o.kt)("p",null,"You need to use a newer version of ",(0,o.kt)("inlineCode",{parentName:"p"},"graphql-engine")," to downgrade to an\nolder version, since only the newer version knows how to downgrade from\nthat point in time. After you\u2019ve executed the ",(0,o.kt)("inlineCode",{parentName:"p"},"downgrade")," command using\nthe newer version, you should switch to the older version and run\n",(0,o.kt)("inlineCode",{parentName:"p"},"graphql-engine serve")," as normal."),(0,o.kt)("p",null,"Catalogue version downgrades will be executed sequentially and in a\nsingle transaction."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Running this command while Hasura GraphQL engine is running might lead\nto unexpected results. It is recommended to first bring down any running\nHasura GraphQL engine instances before downgrading the catalogue"))),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You can downgrade a Hasura GraphQL engine v2 instance to v1 only if\nthere is only one database connected to it."))))}g.isMDXComponent=!0}}]);