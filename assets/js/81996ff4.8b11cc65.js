"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7677],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(a),m=o,h=d["".concat(s,".").concat(m)]||d[m]||c[m]||r;return a?n.createElement(h,i(i({ref:t},u),{},{components:a})):n.createElement(h,i({ref:t},u))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6871:function(e,t,a){a.r(t),a.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return c}});var n=a(83117),o=a(80102),r=(a(67294),a(3905)),i=["components"],l={description:"Guide for managing development environments for Hasura Cloud",keywords:["hasura","docs","cloud","guide","local dev","staging","production","environment"],sidebar_label:"Managing development environments",sidebar_position:10},s="Managing development environments with Hasura Cloud",p={unversionedId:"graphql/cloud/projects/environments",id:"graphql/cloud/projects/environments",title:"Managing development environments with Hasura Cloud",description:"Guide for managing development environments for Hasura Cloud",source:"@site/docs/graphql/cloud/projects/environments.mdx",sourceDirName:"graphql/cloud/projects",slug:"/graphql/cloud/projects/environments",permalink:"/docs/latest/graphql/cloud/projects/environments",editUrl:"https://github.com/hasura/graphql-engine/edit/master/docs/docs/graphql/cloud/projects/environments.mdx",tags:[],version:"current",sidebarPosition:10,frontMatter:{description:"Guide for managing development environments for Hasura Cloud",keywords:["hasura","docs","cloud","guide","local dev","staging","production","environment"],sidebar_label:"Managing development environments",sidebar_position:10},sidebar:"cloudDocsSidebar",previous:{title:"Deployment regions",permalink:"/docs/latest/graphql/cloud/projects/regions"},next:{title:"GitHub deployment",permalink:"/docs/latest/graphql/cloud/projects/github-integration"}},u={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Moving from Hasura Cloud to local development",id:"moving-from-hasura-cloud-to-local-development",level:2},{value:"Step 1: Setup local development of Hasura with Docker",id:"step-1-setup-local-development-of-hasura-with-docker",level:3},{value:"Step 2: Install Hasura CLI",id:"step-2-install-hasura-cli",level:3},{value:"Step 3: Initialize a Hasura CLI project locally",id:"step-3-initialize-a-hasura-cli-project-locally",level:3},{value:"Step 4: Initialize the migration files",id:"step-4-initialize-the-migration-files",level:3},{value:"Step 5: Export metadata",id:"step-5-export-metadata",level:3},{value:"Step 6: Apply metadata and migrations to your local Hasura instance",id:"step-6-apply-metadata-and-migrations-to-your-local-hasura-instance",level:3},{value:"Moving from local development to Hasura Cloud",id:"moving-from-local-development-to-hasura-cloud",level:2},{value:"Setting up a Git repo for your Hasura project",id:"setting-up-a-git-repo-for-your-hasura-project",level:3},{value:"Step 1: Install Hasura CLI",id:"step-1-install-hasura-cli",level:3},{value:"Step 2: Setup a project directory",id:"step-2-setup-a-project-directory",level:3},{value:"Step 3: Initialize the migration files",id:"step-3-initialize-the-migration-files",level:3},{value:"Step 4: Initialize Hasura metadata",id:"step-4-initialize-hasura-metadata",level:3},{value:"Step 5: Setup version control &amp; Git Deploy",id:"step-5-setup-version-control--git-deploy",level:3}],d={toc:c};function m(e){var t=e.components,a=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"managing-development-environments-with-hasura-cloud"},"Managing development environments with Hasura Cloud"),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"This guide will show how to configure your Hasura project for easy switching between development environments."),(0,r.kt)("h2",{id:"moving-from-hasura-cloud-to-local-development"},"Moving from Hasura Cloud to local development"),(0,r.kt)("h3",{id:"step-1-setup-local-development-of-hasura-with-docker"},"Step 1: Setup local development of Hasura with Docker"),(0,r.kt)("p",null,"Follow the guide ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/getting-started/docker-simple"},"here")," to get up and running with Hasura GraphQL engine and Postgres as Docker containers in your local system. Make sure that the ENV variable for database connection in your local setup is same as that in your Cloud project. Also add any other ENV variables that you might have set on the Cloud project."),(0,r.kt)("h3",{id:"step-2-install-hasura-cli"},"Step 2: Install Hasura CLI"),(0,r.kt)("p",null,"Follow the instructions in ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/hasura-cli/install-hasura-cli"},"install_hasura_cli")),(0,r.kt)("h3",{id:"step-3-initialize-a-hasura-cli-project-locally"},"Step 3: Initialize a Hasura CLI project locally"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura init <project-name>\n")),(0,r.kt)("h3",{id:"step-4-initialize-the-migration-files"},"Step 4: Initialize the migration files"),(0,r.kt)("p",null,"This will get your database schema from the cloud project to your local setup"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura migrate create init --from-server --endpoint <hasura-cloud-project-url> --admin-secret <admin-secret> --database-name <database-name>\n\n# note down the version\n\n# mark the migration as applied on the cloud project\n\nhasura migrate apply --endpoint <hasura-cloud-project-url> --admin-secret <admin-secret> --version <version-number> --skip-execution\n")),(0,r.kt)("p",null,"It is important to mark the migration as applied on the Cloud project to ensure that the schema that is already created on Hasura Cloud project is not attempted to be recreated again, which would end in an error state."),(0,r.kt)("h3",{id:"step-5-export-metadata"},"Step 5: Export metadata"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura metadata export --endpoint <hasura-project-url> --admin-secret <admin-secret>\n")),(0,r.kt)("p",null,"We have successfully synced our state from Cloud to the Hasura CLI local dev environment."),(0,r.kt)("p",null,"Next, we apply all these changes to our local Hasura with Docker setup."),(0,r.kt)("h3",{id:"step-6-apply-metadata-and-migrations-to-your-local-hasura-instance"},"Step 6: Apply metadata and migrations to your local Hasura instance"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura metadata apply\nhasura migrate apply --all-databases\nhasura metadata reload\n")),(0,r.kt)("p",null,"By default the metadata and migrations are applied to ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:8080")," which is the endpoint specified in the ",(0,r.kt)("inlineCode",{parentName:"p"},"config.yaml")," file of your CLI project. If you want to apply the metadata and migrations to any other endpoint, you could go ahead and change the endpoint in the ",(0,r.kt)("inlineCode",{parentName:"p"},"config.yaml")," file or use the ",(0,r.kt)("inlineCode",{parentName:"p"},"--endpoint")," flag along with the commands above."),(0,r.kt)("p",null,"And you're all set now! Go ahead and setup version control for your project for further ease of integration."),(0,r.kt)("h2",{id:"moving-from-local-development-to-hasura-cloud"},"Moving from local development to Hasura Cloud"),(0,r.kt)("p",null,"If you have been using the OSS version of Hasura GraphQL engine locally using Docker and want to move to a Hasura Cloud project, start by creating a project at ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.hasura.io/signup"},"https://cloud.hasura.io/signup")),(0,r.kt)("p",null,"Once the project is created, launch console and connect your database. Make sure that the name of the database is same as that in your local setup. Do refer this ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/cloud/getting-started/index"},"Getting Started guide")," for a step-by-step guide."),(0,r.kt)("p",null,"Also ensure the database is connected using the same ENV var in your local setup and the Cloud project. You might have drop and create a new ENV var containing the database URL on your Cloud project if required."),(0,r.kt)("p",null,"Also add any other ENV vars that you might have set on your local project."),(0,r.kt)("h3",{id:"setting-up-a-git-repo-for-your-hasura-project"},"Setting up a Git repo for your Hasura project"),(0,r.kt)("p",null,"In order to easily apply your local changes to your new Cloud project, we'll use the Hasura ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/cloud/projects/github-integration"},"GitHub deployment")," feature. But before we do that, we need to setup metadata & migrations of your local setup that you can apply to your Cloud project. For a lowdown on Hasura metadata & migrations refer the guide ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/migrations/index"},"here")),(0,r.kt)("h3",{id:"step-1-install-hasura-cli"},"Step 1: Install Hasura CLI"),(0,r.kt)("p",null,"Follow the instructions in ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/hasura-cli/install-hasura-cli"},"install_hasura_cli")),(0,r.kt)("h3",{id:"step-2-setup-a-project-directory"},"Step 2: Setup a project directory"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura init <project-name> --endpoint <local-project-endpoint>\n")),(0,r.kt)("p",null,"Your local project endpoint might be ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:8080")," (based on how it was setup initially). This creates a project directory with ",(0,r.kt)("inlineCode",{parentName:"p"},"migrations")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"metadata")," directories and a ",(0,r.kt)("inlineCode",{parentName:"p"},"config.yaml")," file."),(0,r.kt)("h3",{id:"step-3-initialize-the-migration-files"},"Step 3: Initialize the migration files"),(0,r.kt)("p",null,"This will get your database schema from your local setup into the project folder."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura migrate create init --from-server --admin-secret <admin-secret> --database-name <database-name>\n\n# note down the version\n\n# mark the migration as already applied on the local server\n\nhasura migrate apply --admin-secret <admin-secret> --version <version-number> --skip-execution\n")),(0,r.kt)("h3",{id:"step-4-initialize-hasura-metadata"},"Step 4: Initialize Hasura metadata"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"hasura metadata export\n")),(0,r.kt)("p",null,"This command will export the current Hasura metadata as a bunch of YAML files in the ",(0,r.kt)("inlineCode",{parentName:"p"},"metadata")," directory."),(0,r.kt)("h3",{id:"step-5-setup-version-control--git-deploy"},"Step 5: Setup version control & Git Deploy"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'# in the project directory\n\ngit init\ngit add .\ngit commit -m "initialize metadata and migrations"\n')),(0,r.kt)("p",null,"Push these changes to GitHub repo of your choice."),(0,r.kt)("p",null,"Now we're all set to see the magic of our GitHub integration to deploy the metadata and migrations to your Cloud project by following the steps ",(0,r.kt)("a",{parentName:"p",href:"/docs/latest/graphql/cloud/projects/github-integration"},"here"),"!"))}m.isMDXComponent=!0}}]);