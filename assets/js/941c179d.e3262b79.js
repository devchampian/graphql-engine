"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9043],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=l(n),m=a,g=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return n?r.createElement(g,s(s({ref:t},u),{},{components:n})):r.createElement(g,s({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},17686:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return p}});var r=n(83117),a=n(80102),o=(n(67294),n(3905)),s=["components"],i={description:"Use Postgres functions with Hasura",keywords:["hasura","docs","postgres","functions","stored procedures"],sidebar_position:4,sidebar_label:"Functions"},c="Postgres functions",l={unversionedId:"graphql/core/guides/postgres/functions",id:"graphql/core/guides/postgres/functions",title:"Postgres functions",description:"Use Postgres functions with Hasura",source:"@site/docs/graphql/core/guides/postgres/functions.mdx",sourceDirName:"graphql/core/guides/postgres",slug:"/graphql/core/guides/postgres/functions",permalink:"/graphql-engine/latest/graphql/core/guides/postgres/functions",editUrl:"https://github.com/hasura/graphql-engine/edit/master/docs/docs/graphql/core/guides/postgres/functions.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{description:"Use Postgres functions with Hasura",keywords:["hasura","docs","postgres","functions","stored procedures"],sidebar_position:4,sidebar_label:"Functions"},sidebar:"docsSidebar",previous:{title:"Views",permalink:"/graphql-engine/latest/graphql/core/guides/postgres/views"},next:{title:"Triggers",permalink:"/graphql-engine/latest/graphql/core/guides/postgres/triggers"}},u={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Examples",id:"examples",level:2},{value:"Postgres functions &amp; Hasura",id:"postgres-functions--hasura",level:2}],d={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,s);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"postgres-functions"},"Postgres functions"),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/current/sql-createfunction.html"},"Postgres functions"),"\nallow you to customize your database schema by defining a set of\noperations that can include several statements such as declarations,\nassignments and conditional workflows. Postgres functions are similar to\nviews but allow more procedural computations and can take arguments. SQL\nfunctions are also referred to as ",(0,o.kt)("strong",{parentName:"p"},"stored procedures"),"."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"For more information on Postgres functions, please refer to the\n",(0,o.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/current/sql-createfunction.html"},"Postgres documentation"),"."))),(0,o.kt)("h2",{id:"examples"},"Examples"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Searching articles")),(0,o.kt)("p",null,"We can create the following function that we can call later to search\narticles based on the input text argument ",(0,o.kt)("inlineCode",{parentName:"p"},"search"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-plsql"},"CREATE FUNCTION search_articles(search text)\nRETURNS SETOF article AS $$\n    SELECT *\n    FROM article\n    WHERE\n      title ilike ('%' || search || '%')\n      OR content ilike ('%' || search || '%')\n$$ LANGUAGE sql STABLE;\n")),(0,o.kt)("p",null,"Let's break this function apart:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Function name: ",(0,o.kt)("inlineCode",{parentName:"li"},"search_articles")),(0,o.kt)("li",{parentName:"ul"},"Parameters: there is one parameter where ",(0,o.kt)("inlineCode",{parentName:"li"},"search")," is the name and\n",(0,o.kt)("inlineCode",{parentName:"li"},"text")," is the type"),(0,o.kt)("li",{parentName:"ul"},"Return type: ",(0,o.kt)("inlineCode",{parentName:"li"},"SETOF article")),(0,o.kt)("li",{parentName:"ul"},"Function body: Block from ",(0,o.kt)("inlineCode",{parentName:"li"},"SELECT")," until the end of the ",(0,o.kt)("inlineCode",{parentName:"li"},"WHERE"),"\nclause"),(0,o.kt)("li",{parentName:"ul"},"Language: The response is returned in the ",(0,o.kt)("inlineCode",{parentName:"li"},"sql")," language")),(0,o.kt)("h2",{id:"postgres-functions--hasura"},"Postgres functions & Hasura"),(0,o.kt)("p",null,"Postgres functions can be exposed in Hasura's GraphQL schema as a\ntop-level field or as a computed field for a table. They are typically\nused for performing custom business logic in the database."),(0,o.kt)("p",null,"Refer to ",(0,o.kt)("a",{parentName:"p",href:"/graphql-engine/latest/graphql/core/databases/postgres/schema/custom-functions"},"Custom SQL functions")," and\n",(0,o.kt)("a",{parentName:"p",href:"/graphql-engine/latest/graphql/core/databases/postgres/schema/computed-fields"},"Computed fields")," for more use cases and for\ninstructions on how to create and expose Postgres functions in Hasura."))}m.isMDXComponent=!0}}]);