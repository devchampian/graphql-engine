"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9309],{3905:function(e,t,a){a.d(t,{Zo:function(){return s},kt:function(){return d}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),m=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},s=function(e){var t=m(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),g=m(a),d=r,u=g["".concat(c,".").concat(d)]||g[d]||p[d]||i;return a?n.createElement(u,o(o({ref:t},s),{},{components:a})):n.createElement(u,o({ref:t},s))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=g;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var m=2;m<i;m++)o[m]=a[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},74351:function(e,t,a){a.r(t),a.d(t,{assets:function(){return s},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return l},metadata:function(){return m},toc:function(){return p}});var n=a(83117),r=a(80102),i=(a(67294),a(3905)),o=["components"],l={sidebar_label:"Writing migrations manually (config v2)",sidebar_position:2,description:"Write manual migrations for Hasura GraphQL engine",keywords:["hasura","docs","migration","manual"]},c="Writing migrations manually (config v2)",m={unversionedId:"graphql/core/migrations/config-v2/advanced/writing-migrations-manually",id:"graphql/core/migrations/config-v2/advanced/writing-migrations-manually",title:"Writing migrations manually (config v2)",description:"Write manual migrations for Hasura GraphQL engine",source:"@site/docs/graphql/core/migrations/config-v2/advanced/writing-migrations-manually.mdx",sourceDirName:"graphql/core/migrations/config-v2/advanced",slug:"/graphql/core/migrations/config-v2/advanced/writing-migrations-manually",permalink:"/docs/latest/graphql/core/migrations/config-v2/advanced/writing-migrations-manually",editUrl:"https://github.com/hasura/graphql-engine/edit/master/docs/docs/graphql/core/migrations/config-v2/advanced/writing-migrations-manually.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"Writing migrations manually (config v2)",sidebar_position:2,description:"Write manual migrations for Hasura GraphQL engine",keywords:["hasura","docs","migration","manual"]},sidebar:"docsSidebar",previous:{title:"Auto-apply migrations/metadata when the server starts (config v2)",permalink:"/docs/latest/graphql/core/migrations/config-v2/advanced/auto-apply-migrations"},next:{title:"Rolling back applied migrations (config v2)",permalink:"/docs/latest/graphql/core/migrations/config-v2/advanced/rolling-back-migrations"}},s={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Create migration manually",id:"create-migration-manually",level:2}],g={toc:p};function d(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"writing-migrations-manually-config-v2"},"Writing migrations manually (config v2)"),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"While the Hasura console can auto generate migrations for every action,\nsometimes you might want to write the migrations yourself, by hand.\nUsing the Hasura CLI, you can bootstrap these migration files and write\nthe SQL for the Postgres schema."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"For ",(0,i.kt)("inlineCode",{parentName:"p"},"config v3"),", see ",(0,i.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/migrations/advanced/writing-migrations-manually"},"Writing migrations manually"),"."))),(0,i.kt)("h2",{id:"create-migration-manually"},"Create migration manually"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Set up the migration files:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"hasura migrate create <name-of-migration>\n")),(0,i.kt)("p",{parentName:"li"},"This command will create up and down migration SQL files in the\n",(0,i.kt)("inlineCode",{parentName:"p"},"migrations")," directory.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Edit the file and add your migration actions. For the file format\nand instructions on what actions can be added, refer to\n",(0,i.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/migrations/config-v2/reference/migration-file-format"},"migration file format"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The corresponding Hasura metadata changes, if any, can be made\ndirectly in the appropriate metadata file in the ",(0,i.kt)("inlineCode",{parentName:"p"},"/metadata"),"\ndirectory, refer to ",(0,i.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/migrations/config-v2/reference/metadata-format"},"metadata format"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Apply the migration and metadata:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"hasura migrate apply\nhasura metadata apply\n")))))}d.isMDXComponent=!0}}]);