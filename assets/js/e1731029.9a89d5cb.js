"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1173],{3905:function(e,a,t){t.d(a,{Zo:function(){return c},kt:function(){return u}});var n=t(67294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=n.createContext({}),m=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},c=function(e){var a=m(e.components);return n.createElement(s.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},d=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=m(t),u=r,f=d["".concat(s,".").concat(u)]||d[u]||p[u]||l;return t?n.createElement(f,i(i({ref:a},c),{},{components:t})):n.createElement(f,i({ref:a},c))}));function u(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var l=t.length,i=new Array(l);i[0]=d;var o={};for(var s in a)hasOwnProperty.call(a,s)&&(o[s]=a[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var m=2;m<l;m++)i[m]=t[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},93920:function(e,a,t){t.d(a,{Z:function(){return i}});var n=t(67294),r="tableOfContentsInline_ifKN",l=t(31498);function i(e){var a=e.toc,t=e.minHeadingLevel,i=e.maxHeadingLevel,o=e.filterTOC;return n.createElement("div",{className:r},n.createElement(l.Z,{toc:a,minHeadingLevel:t,maxHeadingLevel:i,className:"table-of-contents",linkClassName:null,filterTOC:o}))}},31498:function(e,a,t){t.d(a,{Z:function(){return m}});var n=t(83117),r=t(80102),l=t(67294),i=t(89575),o=["toc","className","linkClassName","linkActiveClassName","minHeadingLevel","maxHeadingLevel"];function s(e){var a=e.toc,t=e.className,n=e.linkClassName,r=e.isChild;return a.length?l.createElement("ul",{className:r?void 0:t},a.map((function(e){return l.createElement("li",{key:e.id},l.createElement("a",{href:"#"+e.id,className:null!=n?n:void 0,dangerouslySetInnerHTML:{__html:e.value}}),l.createElement(s,{isChild:!0,toc:e.children,className:t,linkClassName:n}))}))):null}function m(e){var a=e.toc,t=e.className,m=void 0===t?"table-of-contents table-of-contents__left-border":t,c=e.linkClassName,p=void 0===c?"table-of-contents__link":c,d=e.linkActiveClassName,u=void 0===d?void 0:d,f=e.minHeadingLevel,g=e.maxHeadingLevel,h=(0,r.Z)(e,o),v=(0,i.LU)(),k=null!=f?f:v.tableOfContents.minHeadingLevel,N=null!=g?g:v.tableOfContents.maxHeadingLevel,y=(0,i.b9)({toc:a,minHeadingLevel:k,maxHeadingLevel:N});"function"==typeof h.filterTOC&&(y=h.filterTOC(y));var b=(0,l.useMemo)((function(){if(p&&u)return{linkClassName:p,linkActiveClassName:u,minHeadingLevel:k,maxHeadingLevel:N}}),[p,u,k,N]);return(0,i.Si)(b),l.createElement(s,(0,n.Z)({toc:y,className:m,linkClassName:p},h))}},18930:function(e,a,t){t.r(a),t.d(a,{assets:function(){return p},contentTitle:function(){return m},default:function(){return f},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return d}});var n=t(83117),r=t(80102),l=(t(67294),t(3905)),i=t(93920),o=["components"],s={sidebar_label:"Metadata format",sidebar_position:3,description:"Hasura Metadata file format reference",keywords:["hasura","docs","metadata","file format"]},m="Metadata format reference",c={unversionedId:"graphql/core/migrations/reference/metadata-format",id:"graphql/core/migrations/reference/metadata-format",title:"Metadata format reference",description:"Hasura Metadata file format reference",source:"@site/docs/graphql/core/migrations/reference/metadata-format.mdx",sourceDirName:"graphql/core/migrations/reference",slug:"/graphql/core/migrations/reference/metadata-format",permalink:"/docs/latest/graphql/core/migrations/reference/metadata-format",editUrl:"https://github.com/hasura/graphql-engine/edit/master/docs/docs/graphql/core/migrations/reference/metadata-format.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_label:"Metadata format",sidebar_position:3,description:"Hasura Metadata file format reference",keywords:["hasura","docs","metadata","file format"]},sidebar:"docsSidebar",previous:{title:"Migration file format",permalink:"/docs/latest/graphql/core/migrations/reference/migration-file-format"},next:{title:"Upgrading to config v3",permalink:"/docs/latest/graphql/core/migrations/upgrade-v3"}},p={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Metadata directory format",id:"metadata-directory-format",level:2},{value:"actions.graphql",id:"actionsgraphql",level:3},{value:"actions.yaml",id:"actionsyaml",level:3},{value:"allow_list.yaml",id:"allow_listyaml",level:3},{value:"cron_triggers.yaml",id:"cron_triggersyaml",level:3},{value:"query_collections.yaml",id:"query_collectionsyaml",level:3},{value:"remote_schemas.yaml",id:"remote_schemasyaml",level:3},{value:"version.yaml",id:"versionyaml",level:3},{value:"databases",id:"databases",level:3},{value:"databases.yaml",id:"databasesyaml",level:3},{value:"public_t1.yaml",id:"public_t1yaml",level:3}],u={toc:d};function f(e){var a=e.components,t=(0,r.Z)(e,o);return(0,l.kt)("wrapper",(0,n.Z)({},u,t,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"metadata-format-reference"},"Metadata format reference"),(0,l.kt)("h2",{id:"introduction"},"Introduction"),(0,l.kt)("p",null,"With ",(0,l.kt)("inlineCode",{parentName:"p"},"config v3"),", the metadata that is exported from the server by the\nCLI is a directory of multiple files/directories."),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"For ",(0,l.kt)("inlineCode",{parentName:"p"},"config v2"),", see ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/migrations/config-v2/reference/metadata-format"},"Metadata format reference (config v2)"),"."))),(0,l.kt)("h2",{id:"metadata-directory-format"},"Metadata directory format"),(0,l.kt)("p",null,"The following files will be generated in the ",(0,l.kt)("inlineCode",{parentName:"p"},"metadata/")," directory of\nyour project:"),(0,l.kt)(i.Z,{toc:d,filterTOC:function(e){return e[1].children},mdxType:"TOCInline"}),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The output of the ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/api-reference/metadata-api/manage-metadata#metadata-export-metadata"},"export_metadata")," metadata API is a JSON\nversion of the metadata files."))),(0,l.kt)("h3",{id:"actionsgraphql"},"actions.graphql"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"actions.graphql")," file contains all the ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/actions/index"},"actions"),"\ndefinitions and ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/actions/types/index"},"custom type")," definitions."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": A query action called ",(0,l.kt)("inlineCode",{parentName:"p"},"greet")," and two custom types called\n",(0,l.kt)("inlineCode",{parentName:"p"},"SampleInput")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"SampleOutput"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-graphql"},"type Query {\n  greet(arg1: SampleInput!): SampleOutput\n}\ninput SampleInput {\n  username: String!\n}\ntype SampleOutput {\n  greetings: String!\n}\n")),(0,l.kt)("h3",{id:"actionsyaml"},"actions.yaml"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"actions.yaml")," file contains metadata related to ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/actions/index"},"actions"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": An action called ",(0,l.kt)("inlineCode",{parentName:"p"},"greet")," with the ",(0,l.kt)("inlineCode",{parentName:"p"},"handler")," set to\n",(0,l.kt)("inlineCode",{parentName:"p"},"<base_url>/greet")," and two custom types called ",(0,l.kt)("inlineCode",{parentName:"p"},"SampleInput")," and\n",(0,l.kt)("inlineCode",{parentName:"p"},"SampleOutput"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'actions:\n  - name: greet\n    definition:\n      kind: ""\n      handler: <base_url>/greet\n      forward_client_headers: true\n      headers:\n        - value: application/json\n          name: Content-Type\ncustom_types:\n  enums: []\n  input_objects:\n    - name: SampleInput\n  objects:\n    - name: SampleOutput\n  scalars: []\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": Same example as above but with the base URL of the\n",(0,l.kt)("inlineCode",{parentName:"p"},"handler")," passed as an environment variable."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'actions:\n  - name: greet\n    definition:\n      kind: ""\n      handler: "{{ACTION_BASE_URL}}/greet"\n      forward_client_headers: true\n      headers:\n        - value: application/json\n          name: Content-Type\ncustom_types:\n  enums: []\n  input_objects:\n    - name: SampleInput\n  objects:\n    - name: SampleOutput\n  scalars: []\n')),(0,l.kt)("h3",{id:"allow_listyaml"},"allow_list.yaml"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"allow_list.yaml")," file contains the metadata related to ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/deployment/allow-list"},"allow lists"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": A query collection called ",(0,l.kt)("inlineCode",{parentName:"p"},"allowed-queries")," set as the\nallow-list."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"- collection: allowed-queries\n")),(0,l.kt)("h3",{id:"cron_triggersyaml"},"cron_triggers.yaml"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"cron_triggers.yaml")," file contains metadata related to ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/scheduled-triggers/create-cron-trigger"},"cron triggers"),". The ",(0,l.kt)("inlineCode",{parentName:"p"},"webhook")," can be an HTTP\nendpoint or an environment variable containing the HTTP endpoint."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": A cron trigger called ",(0,l.kt)("inlineCode",{parentName:"p"},"test-trigger"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"- name: test-trigger\nwebhook: <webhook-url>\nschedule: 0 12 * * 1-5\ninclude_in_metadata: true\npayload: {}\nretry_conf:\n  num_retries: 1\n  timeout_seconds: 60\n  tolerance_seconds: 21600\n  retry_interval_seconds: 10\n")),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The metadata about a cron trigger will not be stored if\n",(0,l.kt)("inlineCode",{parentName:"p"},"Include this trigger in Hasura Metadata")," is disabled in the advanced\noption of ",(0,l.kt)("inlineCode",{parentName:"p"},"events")," on the console or ",(0,l.kt)("inlineCode",{parentName:"p"},"include_in_metadata")," is passed as\n",(0,l.kt)("inlineCode",{parentName:"p"},"false")," via the API."))),(0,l.kt)("h3",{id:"query_collectionsyaml"},"query_collections.yaml"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"query_collections.yaml")," file contains metadata information about\n",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/api-reference/metadata-api/query-collections"},"query collections"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": A query collection called ",(0,l.kt)("inlineCode",{parentName:"p"},"sample-collection")," which\ncontains two queries ",(0,l.kt)("inlineCode",{parentName:"p"},"test")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"test2"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"- name: sample-collection\n  definition:\n    queries:\n      - name: test\n        query: |-\n          query test {\n            books {\n              id\n              author_id\n              title\n            }\n          }\n      - name: test2\n        query: |-\n          query test2 {\n              authors{\n                  id\n                  author_name\n              }\n          }\n")),(0,l.kt)("h3",{id:"remote_schemasyaml"},"remote_schemas.yaml"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"remote_schemas.yaml")," file contains the metadata related to ",(0,l.kt)("a",{parentName:"p",href:"/docs/latest/graphql/core/remote-schemas/index"},"remote schemas"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": A remote schema called ",(0,l.kt)("inlineCode",{parentName:"p"},"my-remote-schema")," with URL\n",(0,l.kt)("inlineCode",{parentName:"p"},"<remote-schema-url>"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"- name: my-remote-schema\n  definition:\n    url: <remote-schema-url>\n    timeout_seconds: 40\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example"),": A remote schema called ",(0,l.kt)("inlineCode",{parentName:"p"},"my-remote-schema")," with URL passed\nas environment variable."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"- name: my-remote-schema\n  definition:\n    url_from_env: REMOTE_SCHEMA\n    timeout_seconds: 40\n")),(0,l.kt)("h3",{id:"versionyaml"},"version.yaml"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"version.yaml")," file contains the metadata format version."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"version: 3\n")),(0,l.kt)("h3",{id:"databases"},"databases"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"metadata\n\u251c\u2500\u2500 actions.graphql\n\u251c\u2500\u2500 actions.yaml\n\u251c\u2500\u2500 allow_list.yaml\n\u251c\u2500\u2500 cron_triggers.yaml\n\u251c\u2500\u2500 databases\n\u2502\xa0\xa0 \u251c\u2500\u2500 databases.yaml\n\u2502\xa0\xa0 \u2514\u2500\u2500 default\n\u2502\xa0\xa0     \u2514\u2500\u2500 tables\n\u2502\xa0\xa0         \u251c\u2500\u2500 public_t1.yaml\n\u251c\u2500\u2500 query_collections.yaml\n\u251c\u2500\u2500 remote_schemas.yaml\n\u2514\u2500\u2500 version.yaml\n")),(0,l.kt)("h3",{id:"databasesyaml"},"databases.yaml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'- name: default\n  configuration:\n    connection_info:\n      database_url: <database_url>\n      pool_settings:\n        idle_timeout: 180\n        max_connections: 50\n        retries: 1\n  tables:\n    - "!include public_t1.yaml"\n  functions: []\n')),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},(0,l.kt)("inlineCode",{parentName:"p"},"database_url")," can be set from an environment variable by specifying it\nas:"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"database_url:\n  from_env: SOME_ENVIRONMENT_VARIABLE\n")))),(0,l.kt)("h3",{id:"public_t1yaml"},"public_t1.yaml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"table:\nname: t1\nschema: public\n")))}f.isMDXComponent=!0}}]);